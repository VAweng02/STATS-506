---
title: "STATS 506 - Homework 2"
author: "Vincent Weng"
format:
  html:
    embed-resources: true
---

<h3>Problem 1 - Dice Game</h3>

Part (A) - Version 1: Implement this game using a loop.
```{r}
#' This is the title of the function
#'
#' @description A detailed description of what the function does.
#'
#' @param x A parameter that does something.
#' @param y Another parameter.
#'
#' @return The result of the function.
play_dice1 <- function(num_rolls) {
  total_winnings <- 0
  for (i in 1:num_rolls) {
    total_winnings <- total_winnings -2 
    roll <- sample(1:6, 1, replace = TRUE)
    if (roll == 3) {
      total_winnings <- total_winnings + 6
    } else if (roll == 5) {
      total_winnings <- total_winnings + 10
    }
  }
  return(total_winnings)
}
```


Part (A) - Version 2: Implement this game using built-in R vectorized functions.
```{r}
play_dice2 <- function(num_rolls) {
  rolls <- sample(1:6, num_rolls, replace = TRUE)
  total_winnings <- ifelse(rolls == 3 | rolls == 5, 2 * rolls, -2)
  total_winnings <- total_winnings - (2*num_rolls)
  return(sum(winnings))
}
```


Part (A) - Version 3: Implement this by rolling all the dice into one and collapsing the die rolls into a single table()
```{r}
# TODO
```



<h3>Problem 2 - Linear Regression</h3>

Part(A) - The names of the variables in this data are way too long. Rename the columns of the data to more reasonable lengths.
```{r}
cars_data <- read.csv("cars.csv")

colnames(cars_data) <- c("dim_height", "dim_length", "dim_width", "eng_drive_line", "eng_type", "eng_hybrid", "eng_num_gears", "eng_transmission", "fuel_city_mpg", "fuel_type", "fuel_highway_mpg", "id_class", "id", "id_make", "id_model_year", "id_year", "eng_horsepower", "eng_torque")
```


Part(B) - Restrict the data to cars whose Fuel Type is “Gasoline”.
```{r}
gasoline_cars <- cars_data[cars_data$fuel_type == "Gasoline", ]
```


Part(C) - Examine the distribution of highway gas mileage. Consider whether a transformation could be used. If so, generate the transformed variable and use this variable going forward. If not, provide a short justification.
```{r}
# highway gas mileage of 223 was removed (outlier)
gasoline_cars <- gasoline_cars[gasoline_cars$fuel_city_mpg < 50, ]

summary(gasoline_cars$fuel_city_mpg)

hist(gasoline_cars$fuel_city_mpg, breaks = 25, main = "Distribution of highway gas mileage", xlab = "highway gas mileage", col = "blue")
```
Part(D) - Fit a linear regression model predicting MPG on the highway. The predictor of interest is torque. Control for:

- The horsepower of the engine
- All three dimensions of the car
- The year the car was released, as a categorical variable.

Briefly discuss the estimated relationship between torque and highway MPG. Be precise about the interpretation of the estimated coefficient.
```{r}
model <- lm(fuel_highway_mpg ~ eng_torque + eng_horsepower + dim_length + dim_width + dim_height + as.factor(id_year), data = gasoline_cars)
summary(model)
```

Part(E) - It seems reasonable that there may be an interaction between torque and horsepower. Refit the model (with lm) and generate an interaction plot, showing how the relationship between torque and MPG changes as horsepower changes. Choose reasonable values of torque, and show lines for three different reasonable values of horsepower.
```{r}
model <- lm(fuel_highway_mpg ~ eng_torque*eng_horsepower + dim_length + dim_width + dim_height + as.factor(id_year), data = gasoline_cars)

library(interactions)
interact_plot(model, pred = eng_horsepower, modx = eng_torque,at = list(id_year = 2012))
```



